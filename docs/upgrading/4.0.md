---
layout: default
title: Upgrading from 3.x to 4.x
---

<p class="message-notice">This is the documentation for the upcoming <code>version 4.0</code>. This is a work in progress.</p>

# Upgrading from 3.x to 4.x

`League\Period 4.0` is a new major version that comes with backward compatibility breaks.

This guide will help you migrate from a 3.x version to 4.0. It will only explain backward compatibility breaks, it will not present the new features ([read the documentation for that](/4.0/)).

## Installation

If you are using composer then you should update the require section of your `composer.json` file.

~~~
composer require league/period:^4.0
~~~

This will edit (or create) your `composer.json` file.

## PHP version requirement

`League\Period 4.0` requires a PHP version greater or equal than 7.1.3 (was previously 5.5.9).

<p class="message-warning"><code>HHVM</code> support is dropped.</p>

## The Period class

### Removed methods

- `Period::next`
- `Period::previous`
- `Period::add`
- `Period::sub`
- `Period::createFromYear`
- `Period::createFromMonth`
- `Period::createFromWeek`
- `Period::createFromDay`
- `Period::createFromSemester`
- `Period::createFromQuarter`
- `Period::createFromDuration`
- `Period::createFromDurationBeforeEnd`
- `Period::sameValueAs`
- `Period::sameDurationAs`
- `Period::compareDuration`
- `Period::withDuration`

#### `Period::next`, `Period::previous`, `Period::add`, `Period::sub`

These methods where already marked as deprecated is the 3.x line. They are now removed from the class.

#### `Period::sameValueAs`

To detect if two `Period` object are equal you must use the new `Period::equals` method instead.

Before:

~~~php
$orig  = Period::createFromMonth(2014, 3);
$alt   = Period::createFromMonth(2014, 4);
$other = new Period('2014-03-01', '2014-04-01');

$orig->sameValueAs($alt);   //return false
$orig->sameValueAs($other); //return true
~~~

After:

~~~php
$orig  = month(2014, 3);
$alt   = month(2014, 4);
$other = new Period('2014-03-01', '2014-04-01');

$orig->equals($alt);   //return false
$orig->equals($other); //return true
~~~

#### Named constructors

To reduce code and allow more flexibility all named constructors have been removed from the `Period` class.

| Previous Named constructors           |  new helper functions           |
| ------------------------------------- | ------------------------------- |
| `Period::createFromYear`              | `League\Period\year`            |
| `Period::createFromMonth`             | `League\Period\month`           |
| `Period::createFromWeek`              | `League\Period\iso_week`        |
| `Period::createFromDay`               | `League\Period\day`             |
| `Period::createFromSemester`          | `League\Period\semester`        |
| `Period::createFromQuarter`           | `League\Period\quarter`         |
| `Period::createFromDuration`          | `League\Period\interval_after`  |
| `Period::createFromDurationBeforeEnd` | `League\Period\interval_before` |

The functions take the same arguments in the same order.

Before:

~~~php
use League\Period\Period;

$period = Period::createFromDuration('2014-03-01', '1 MONTH');
~~~

After:

~~~php
use function League\Period\interval_after;

$period = interval_after('2014-03-01', '1 MONTH');
~~~

To remove ambiguity, the following methods have been renamed

| previous method name          |  new method name                 |
| ----------------------------- | -------------------------------- |
| `Period::sameValueAs`         | `Period::equals`                 |
| `Period::sameDurationAs`      | `Period::durationEquals`         |
| `Period::compareDuration`     | `Period::durationCompare`        |
| `Period::withDuration`        | `Period::withDurationAfterStart` |

Before:

~~~php
$period = Period::createFromDuration('2014-03-01', '1 MONTH');
$alt_period = $period->withDuration('1 WEEK');
~~~

After:

~~~php
$period = interval_after('2014-03-01', '1 MONTH');
$alt_period = $period->withDurationAfterStart('1 WEEK');
~~~

#### `Period::jsonSerialize`

The output from `Period::jsonSerialize` has been updated to enable a better translation between the PHP and the Javascript DateTime notation.

Before:

~~~php
date_default_timezone_set('Africa/Kinshasa');

use League\Period\Period;

$period = new Period('2014-05-01 00:00:00', '2014-05-08 00:00:00');

$res = json_decode(json_encode($period), true);
//  $res will be equivalent to:
// [
//      'startDate' => [
//          'date' => '2014-05-01 00:00:00',
//          'timezone_type' => 3,
//          'timezone' => 'Africa/Kinshasa',
//      ],
//      'endDate' => [
//          'date' => '2014-05-08 00:00:00',
//          'timezone_type' => 3,
//          'timezone' => 'Africa/Kinshasa',
//      ],
// ]
~~~

After:

~~~php
date_default_timezone_set('Africa/Kinshasa');

$period = new Period('2014-05-01 00:00:00', '2014-05-08 00:00:00');

$res = json_decode(json_encode($period), true);
//  $res will be equivalent to:
// [
//      'startDate' => '2014-04-30T23:00:00.000000Z,
//      'endDate' => '2014-05-07T23:00:00.000000Z',
// ]
~~~